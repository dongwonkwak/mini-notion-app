{
  "name": "Security Scan",
  "description": "ì½”ë“œ ë³´ì•ˆ ì·¨ì•½ì  ë° ë¯¼ê° ì •ë³´ ë…¸ì¶œì„ ê²€ì‚¬í•©ë‹ˆë‹¤",
  "trigger": {
    "type": "manual",
    "button_text": "ğŸ”’ ë³´ì•ˆ ìŠ¤ìº”"
  },
  "prompt": "**ë³´ì•ˆ ìŠ¤ìº”**ì„ ìˆ˜í–‰í•˜ì—¬ ì·¨ì•½ì ê³¼ ë¯¼ê° ì •ë³´ ë…¸ì¶œì„ ê²€ì‚¬í•©ë‹ˆë‹¤:\n\n## ğŸ” **1ë‹¨ê³„: ì˜ì¡´ì„± ì·¨ì•½ì  ìŠ¤ìº”**\n```bash\n# npm auditìœ¼ë¡œ ì•Œë ¤ì§„ ì·¨ì•½ì  í™•ì¸\npnpm audit\n\n# ì‹¬ê°ë„ë³„ ì·¨ì•½ì  ë¶„ë¥˜\npnpm audit --audit-level moderate\n\n# ìë™ ìˆ˜ì • ê°€ëŠ¥í•œ ì·¨ì•½ì  ìˆ˜ì •\npnpm audit --fix\n```\n\n## ğŸ” **2ë‹¨ê³„: ë¯¼ê° ì •ë³´ ë…¸ì¶œ ê²€ì‚¬**\n\n### í•˜ë“œì½”ë”©ëœ ì‹œí¬ë¦¿ ê²€ì‚¬\n```bash\n# API í‚¤ íŒ¨í„´ ê²€ì‚¬\ngrep -r \"api[_-]key\\|apikey\" --include=\"*.ts\" --include=\"*.js\" --include=\"*.tsx\" --include=\"*.jsx\" .\n\n# ë¹„ë°€ë²ˆí˜¸ íŒ¨í„´ ê²€ì‚¬  \ngrep -r \"password\\s*=\\s*['\\\"]\" --include=\"*.ts\" --include=\"*.js\" .\n\n# JWT í† í° íŒ¨í„´ ê²€ì‚¬\ngrep -r \"eyJ[A-Za-z0-9-_]*\" --include=\"*.ts\" --include=\"*.js\" .\n\n# ë°ì´í„°ë² ì´ìŠ¤ URL ê²€ì‚¬\ngrep -r \"postgresql://\\|mysql://\\|mongodb://\" --include=\"*.ts\" --include=\"*.js\" .\n```\n\n### í™˜ê²½ ë³€ìˆ˜ ëˆ„ì¶œ ê²€ì‚¬\n```bash\n# .env íŒŒì¼ì´ Gitì— ì¶”ê°€ë˜ì—ˆëŠ”ì§€ í™•ì¸\ngit ls-files | grep \"\\.env$\"\n\n# process.env ì‚¬ìš© íŒ¨í„´ ê²€ì‚¬ (í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ)\ngrep -r \"process\\.env\" apps/web/src/ --include=\"*.ts\" --include=\"*.tsx\"\n```\n\n## ğŸ›¡ï¸ **3ë‹¨ê³„: ì½”ë“œ ë³´ì•ˆ íŒ¨í„´ ê²€ì‚¬**\n\n### ìœ„í—˜í•œ í•¨ìˆ˜ ì‚¬ìš© ê²€ì‚¬\n```bash\n# eval() ì‚¬ìš© ê²€ì‚¬\ngrep -r \"eval\\s*\\(\" --include=\"*.ts\" --include=\"*.js\" .\n\n# innerHTML ì‚¬ìš© ê²€ì‚¬ (XSS ìœ„í—˜)\ngrep -r \"\\.innerHTML\\s*=\" --include=\"*.ts\" --include=\"*.tsx\" .\n\n# dangerouslySetInnerHTML ì‚¬ìš© ê²€ì‚¬\ngrep -r \"dangerouslySetInnerHTML\" --include=\"*.tsx\" .\n```\n\n### SQL ì¸ì ì…˜ íŒ¨í„´ ê²€ì‚¬\n```bash\n# ë¬¸ìì—´ ì—°ê²°ë¡œ ì¿¼ë¦¬ ìƒì„± íŒ¨í„´\ngrep -r \"SELECT.*+\\|INSERT.*+\\|UPDATE.*+\" --include=\"*.ts\" --include=\"*.js\" .\n\n# Prisma raw ì¿¼ë¦¬ ì‚¬ìš© ê²€ì‚¬\ngrep -r \"\\$queryRaw\\|\\$executeRaw\" --include=\"*.ts\" .\n```\n\n## ğŸ”’ **4ë‹¨ê³„: ì¸ì¦ ë° ê¶Œí•œ ê²€ì‚¬**\n\n### JWT í† í° ì²˜ë¦¬ ê²€ì‚¬\n```bash\n# JWT ì‹œí¬ë¦¿ í•˜ë“œì½”ë”© ê²€ì‚¬\ngrep -r \"jwt.*secret\" --include=\"*.ts\" --include=\"*.js\" .\n\n# í† í° ë§Œë£Œ ì‹œê°„ ì„¤ì • í™•ì¸\ngrep -r \"expiresIn\\|exp:\" --include=\"*.ts\" --include=\"*.js\" .\n```\n\n### ê¶Œí•œ ê²€ì¦ ë¡œì§ í™•ì¸\n```bash\n# ê¶Œí•œ ì²´í¬ ì—†ëŠ” API ì—”ë“œí¬ì¸íŠ¸ ê²€ì‚¬\ngrep -r \"export.*function\\|app\\.(get\\|post\\|put\\|delete)\" apps/api/src/ --include=\"*.ts\"\n```\n\n## ğŸ“Š **5ë‹¨ê³„: íŒŒì¼ ê¶Œí•œ ë° ì„¤ì • ê²€ì‚¬**\n\n### íŒŒì¼ ê¶Œí•œ í™•ì¸\n```bash\n# ì‹¤í–‰ ê¶Œí•œì´ ìˆëŠ” íŒŒì¼ í™•ì¸\nfind . -type f -perm +111 -not -path \"./node_modules/*\" -not -path \"./.git/*\"\n\n# ë¯¼ê°í•œ íŒŒì¼ì˜ ê¶Œí•œ í™•ì¸\nls -la .env* 2>/dev/null || echo \"í™˜ê²½ ë³€ìˆ˜ íŒŒì¼ ì—†ìŒ\"\n```\n\n### Docker ë³´ì•ˆ ì„¤ì • í™•ì¸\n```bash\n# Docker Compose ë³´ì•ˆ ì„¤ì • ê²€ì‚¬\ngrep -A 5 -B 5 \"privileged\\|user.*root\" docker-compose.yml || echo \"Docker ë³´ì•ˆ ì„¤ì • ì–‘í˜¸\"\n```\n\n## ğŸ“‹ **ë³´ì•ˆ ìŠ¤ìº” ê²°ê³¼ ë¦¬í¬íŠ¸**\n\n```\nğŸ”’ ë³´ì•ˆ ìŠ¤ìº” ê²°ê³¼\n\nğŸ“¦ ì˜ì¡´ì„± ì·¨ì•½ì :\nâœ… ì‹¬ê°í•œ ì·¨ì•½ì : 0ê°œ\nâš ï¸  ì¤‘ê°„ ì·¨ì•½ì : 2ê°œ (ì—…ë°ì´íŠ¸ ê¶Œì¥)\nâœ… ë‚®ì€ ì·¨ì•½ì : 5ê°œ (ëª¨ë‹ˆí„°ë§)\n\nğŸ” ë¯¼ê° ì •ë³´ ë…¸ì¶œ:\nâœ… API í‚¤ í•˜ë“œì½”ë”©: ë°œê²¬ë˜ì§€ ì•ŠìŒ\nâœ… ë¹„ë°€ë²ˆí˜¸ í•˜ë“œì½”ë”©: ë°œê²¬ë˜ì§€ ì•ŠìŒ\nâš ï¸  .env íŒŒì¼: .gitignoreì— í¬í•¨ë¨ (ì–‘í˜¸)\n\nğŸ›¡ï¸ ì½”ë“œ ë³´ì•ˆ íŒ¨í„´:\nâœ… eval() ì‚¬ìš©: ë°œê²¬ë˜ì§€ ì•ŠìŒ\nâš ï¸  innerHTML ì‚¬ìš©: 2ê³³ ë°œê²¬ (ê²€í†  í•„ìš”)\nâœ… SQL ì¸ì ì…˜ ìœ„í—˜: ë°œê²¬ë˜ì§€ ì•ŠìŒ\n\nğŸ”’ ì¸ì¦ ë° ê¶Œí•œ:\nâœ… JWT ì‹œí¬ë¦¿: í™˜ê²½ ë³€ìˆ˜ ì‚¬ìš©\nâœ… í† í° ë§Œë£Œ: ì ì ˆíˆ ì„¤ì •ë¨\nâš ï¸  API ê¶Œí•œ ê²€ì¦: 3ê°œ ì—”ë“œí¬ì¸íŠ¸ ê²€í†  í•„ìš”\n\nğŸ“ íŒŒì¼ ë° ì„¤ì •:\nâœ… íŒŒì¼ ê¶Œí•œ: ì ì ˆí•¨\nâœ… Docker ë³´ì•ˆ: ì–‘í˜¸\n\nğŸ¯ ì „ì²´ ë³´ì•ˆ ì ìˆ˜: 85/100 (ì–‘í˜¸)\n```\n\n## ğŸš¨ **ë°œê²¬ëœ ë¬¸ì œ í•´ê²° ê°€ì´ë“œ**\n\n### ì˜ì¡´ì„± ì·¨ì•½ì \n```bash\n# íŠ¹ì • íŒ¨í‚¤ì§€ ì—…ë°ì´íŠ¸\npnpm update [package-name]\n\n# ëª¨ë“  íŒ¨í‚¤ì§€ ìµœì‹  ë²„ì „ìœ¼ë¡œ ì—…ë°ì´íŠ¸\npnpm update --latest\n```\n\n### innerHTML ì‚¬ìš© ë¬¸ì œ\n```typescript\n// âŒ ìœ„í—˜í•œ ë°©ë²•\nelement.innerHTML = userInput;\n\n// âœ… ì•ˆì „í•œ ë°©ë²•\nelement.textContent = userInput;\n// ë˜ëŠ” DOMPurify ì‚¬ìš©\nelement.innerHTML = DOMPurify.sanitize(userInput);\n```\n\n### API ê¶Œí•œ ê²€ì¦ ëˆ„ë½\n```typescript\n// âœ… ê¶Œí•œ ê²€ì¦ ì¶”ê°€\nexport async function handler(req: NextApiRequest, res: NextApiResponse) {\n  // ì¸ì¦ í™•ì¸\n  const session = await getServerSession(req, res, authOptions);\n  if (!session) {\n    return res.status(401).json({ error: 'Unauthorized' });\n  }\n  \n  // ê¶Œí•œ í™•ì¸\n  if (!hasPermission(session.user, 'required-permission')) {\n    return res.status(403).json({ error: 'Forbidden' });\n  }\n  \n  // ì‹¤ì œ ë¡œì§\n}\n```\n\n**ê¶Œì¥ ì‹¤í–‰ ì£¼ê¸°**: ì£¼ 1íšŒ ë˜ëŠ” ìƒˆë¡œìš´ ì˜ì¡´ì„± ì¶”ê°€ ì‹œ",
  "auto_execute": false,
  "enabled": true
}
